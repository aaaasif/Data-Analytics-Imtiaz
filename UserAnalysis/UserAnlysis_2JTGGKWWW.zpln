{
  "paragraphs": [
    {
      "text": "%pyspark\nfrom pyspark import HiveContext\nfrom pyspark.sql import SparkSession\nhc = HiveContext(sc)\ndf = hc.table('users')\ndf.show()\n\n",
      "user": "anonymous",
      "dateUpdated": "2024-03-12T22:37:05+0600",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------------------+---------+-----------------+-------------------+--------------------+-----------+----------+---------+---------+--------------------+------------------+-------------------+--------------------+-----------------------+--------------------+--------------------+--------------------+---------------------+--------------------+---------------------+----------------------+----------------------+\n|             user_id|user_name|user_review_count| user_yelping_since|        user_friends|user_useful|user_funny|user_cool|user_fans|          user_elite|user_average_stars|user_compliment_hot|user_compliment_more|user_compliment_profile|user_compliment_cute|user_compliment_list|user_compliment_note|user_compliment_plain|user_compliment_cool|user_compliment_funny|user_compliment_writer|user_compliment_photos|\n+--------------------+---------+-----------------+-------------------+--------------------+-----------+----------+---------+---------+--------------------+------------------+-------------------+--------------------+-----------------------+--------------------+--------------------+--------------------+---------------------+--------------------+---------------------+----------------------+----------------------+\n|qVc8ODYU5SZjKXVBg...|   Walker|              585|2007-01-25 16:47:26|NSCy54eWehBJyZdG2...|       7217|      1259|     5994|      267|                2007|              3.91|                250|                  65|                     55|                  56|                  18|                 232|                  844|                 467|                  467|                   239|                   180|\n|j14WgRoU_-2ZE1aw1...|   Daniel|             4333|2009-01-25 04:35:42|ueRPE0CX75ePGMqOF...|      43091|     13066|    27281|     3138|2009,2010,2011,20...|              3.74|               1145|                 264|                    184|                 157|                 251|                1847|                 7054|                3131|                 3131|                  1521|                  1946|\n|2WnXYQFK0hXEoTxPt...|    Steph|              665|2008-07-25 10:41:00|LuO3Bn4f3rlhyHIaN...|       2086|      1010|     1003|       52|2009,2010,2011,20...|              3.32|                 89|                  13|                     10|                  17|                   3|                  66|                   96|                 119|                  119|                    35|                    18|\n|SZDeASXq7o05mMNLs...|     Gwen|              224|2005-11-29 04:38:33|enx1vVPnfdNUdPho6...|        512|       330|      299|       28|      2009,2010,2011|              4.27|                 24|                   4|                      1|                   6|                   2|                  12|                   16|                  26|                   26|                    10|                     9|\n|hA5lMy-EnncsH4JoR...|    Karen|               79|2007-01-05 19:40:59|PBK4q9KEEBHhFvSXC...|         29|        15|        7|        1|                    |              3.54|                  1|                   1|                      0|                   0|                   0|                   1|                    1|                   0|                    0|                     0|                     0|\n|q_QQ5kBBwlCcbL1s4...|     Jane|             1221|2005-03-14 20:26:35|xBDpTUbai0DXrvxCe...|      14953|      9940|    11211|     1357|2006,2007,2008,20...|              3.85|               1713|                 163|                    191|                 361|                 147|                1212|                 5696|                2543|                 2543|                   815|                   323|\n|cxuxXkcihfCbqt5By...|      Rob|               12|2009-02-24 03:09:06|HDAQ74AEznP-YsMk1...|          6|         1|        0|        1|                    |              2.75|                  0|                   0|                      0|                   0|                   0|                   0|                    1|                   0|                    0|                     0|                     0|\n|E9kcWJdJUHuTKfQur...|     Mike|              358|2008-12-11 22:11:56|y2GyxJF5VQWohxgw_...|        399|       102|      143|       23|                    |              3.73|                  4|                   7|                      2|                   0|                   0|                   8|                    6|                  12|                   12|                     5|                     0|\n|lO1iq-f75hnPNZkTy...| Rachelle|               40|2008-12-29 22:40:56|tOQDlz36rI__SOsbL...|        109|        40|       46|        7|                    |              4.04|                  2|                   0|                      0|                   3|                   0|                   3|                    4|                   5|                    5|                     3|                     1|\n|AUi8MPWJ0mLkMfwbu...|     John|              109|2010-01-07 18:32:04|gy5fWeSv3Gamuq9Ox...|        154|        20|       23|        4|                    |               3.4|                  0|                   0|                      0|                   0|                   0|                   1|                    6|                   3|                    3|                     0|                     0|\n|iYzhPPqnrjJkg1JHZ...|    Chris|                4|2010-11-03 18:59:20|Vq4Pc81l6MWTnc-h4...|          1|         0|        1|        1|                    |               4.0|                  0|                   0|                      0|                   0|                   0|                   0|                    0|                   0|                    0|                     0|                     0|\n|xoZvMJPDW6Q9pDAXI...|     Ryan|              535|2009-05-27 06:12:10|6tbXpUIU6upoeqWND...|       1130|       487|      573|       31| 2009,2010,2011,2012|              3.89|                 23|                   9|                      1|                   3|                   5|                  31|                   41|                  36|                   36|                    24|                     7|\n|vVukUtqoLF5BvH_Vt...| Charlene|               37|2011-01-29 17:18:59|zkK6c9BcDyqreU0fq...|         63|         3|       27|        4|                    |              4.51|                  4|                   0|                      0|                   0|                   0|                   1|                    5|                   0|                    0|                     1|                     0|\n|_crIokUeTCHVK_JVO...|    Kenny|               11|2009-10-07 17:23:44|f0mdrhyxVZ0TsFZD5...|         30|         3|        0|        0|                    |              3.08|                  0|                   0|                      0|                   0|                   0|                   0|                    0|                   0|                    0|                     0|                     0|\n|1McG5Rn_UDkmlkZOr...|   Teresa|                7|2009-05-26 16:11:11|piejMEdRkGB7-1aL4...|         18|         3|       13|        1|                    |              4.29|                  1|                   0|                      0|                   0|                   0|                   1|                    0|                   2|                    2|                     0|                     0|\n|SgiBkhXeqIKl1PlFp...|   Eugene|              682|2006-08-25 16:47:25|j3MBGSLaXMlhLZNeA...|       1819|      1138|     1297|       44|2007,2008,2009,20...|              3.75|                212|                  17|                     17|                  22|                  34|                  67|                  158|                 221|                  221|                    45|                    17|\n|fJZO_skqpnhk1kvom...| Jennifer|               25|2008-07-14 16:01:36|hJiJzw6obCmbGAfwr...|         29|         2|       19|        1|                    |              4.15|                  0|                   1|                      0|                   0|                   0|                   6|                    2|                   2|                    2|                     1|                     0|\n|x7YtLnBW2dUnrrpwa...|  Ronskee|               37|2010-05-06 00:40:56|EPBLDry-ObheloH-N...|         56|        29|       29|        9|                    |              3.84|                 15|                   1|                      0|                   0|                   0|                  12|                   33|                  66|                   66|                     1|                    12|\n|QF1Kuhs8iwLWANNZx...|Catherine|              607|2009-04-27 20:25:54|dLts9bY66tXEFqYG0...|       4573|      3714|     4149|      131|2010,2011,2012,20...|              4.11|               1020|                  79|                     68|                  29|                  23|                 144|                  407|                 808|                  808|                   587|                   723|\n|VcLRGCG_VbAo8MxOm...|       AJ|              133|2009-07-11 16:47:38|Ynu2Z2L8Wv2fbTwQ_...|        201|        52|       44|        4|                    |               3.6|                  1|                   0|                      0|                   0|                   0|                   2|                    4|                   0|                    0|                     1|                     0|\n+--------------------+---------+-----------------+-------------------+--------------------+-----------+----------+---------+---------+--------------------+------------------+-------------------+--------------------+-----------------------+--------------------+--------------------+--------------------+---------------------+--------------------+---------------------+----------------------+----------------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://node-master:4040/jobs",
              "$$hashKey": "object:5577"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1710213664250_214306058",
      "id": "paragraph_1710213664250_214306058",
      "dateCreated": "2024-03-12T09:21:04+0600",
      "dateStarted": "2024-03-12T22:37:05+0600",
      "dateFinished": "2024-03-12T22:37:06+0600",
      "status": "FINISHED",
      "focus": true,
      "$$hashKey": "object:5405"
    },
    {
      "text": "%pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2024-03-12T15:13:38+0600",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1710234818350_15380386",
      "id": "paragraph_1710234818350_15380386",
      "dateCreated": "2024-03-12T15:13:38+0600",
      "status": "READY",
      "$$hashKey": "object:5406"
    },
    {
      "text": "%pyspark\nfrom pyspark import HiveContext\nfrom pyspark.sql.functions import sum\n\n# Create a HiveContext\nhc = HiveContext(sc)\n\n# Read the table 'users' from Hive\nusers_df = hc.table('users')\n\n# Calculate the total review count\ntotal_review_count = users_df.select(sum(\"user_review_count\")).collect()[0][0]\n\n# Show the total review count\nprint(\"Total Review Count:\", total_review_count)\n",
      "user": "anonymous",
      "dateUpdated": "2024-03-13T02:09:49+0600",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Total Review Count: 46505676\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://node-master:4040/jobs",
              "$$hashKey": "object:5603"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1710223526611_432208226",
      "id": "paragraph_1710223526611_432208226",
      "dateCreated": "2024-03-12T12:05:26+0600",
      "dateStarted": "2024-03-13T02:09:49+0600",
      "dateFinished": "2024-03-13T02:12:14+0600",
      "status": "FINISHED",
      "$$hashKey": "object:5407"
    },
    {
      "text": "%pyspark\n#       Analyze the yearly growth of user sign-ups.\nfrom pyspark import HiveContext\nfrom pyspark.sql.functions import year, count\n\n# Create a HiveContext\nhc = HiveContext(sc)\n\n# Read the table 'users' from Hive\ndf = hc.table('users')\n\n# Calculate yearly sign-ups for all users\nyearly_signups = df.withColumn(\"signup_year\", year(\"user_yelping_since\")) \\\n    .groupBy(\"signup_year\") \\\n    .agg(count(\"*\").alias(\"total_signups\")) \\\n    .orderBy(\"signup_year\")\n\n# Show the yearly sign-ups\nz.show(yearly_signups)\n",
      "user": "anonymous",
      "dateUpdated": "2024-03-13T07:27:17+0600",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "signup_year": "string",
                      "total_signups": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                },
                "stackedAreaChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                },
                "lineChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "signup_year",
                  "index": 0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "total_signups",
                  "index": 1,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "signup_year\ttotal_signups\n2004\t90\n2005\t937\n2006\t5423\n2007\t15340\n2008\t31097\n2009\t64911\n2010\t109054\n2011\t176435\n2012\t195955\n2013\t209762\n2014\t233465\n2015\t247850\n2016\t217620\n2017\t151024\n2018\t133568\n2019\t104655\n2020\t47444\n2021\t40485\n2022\t2782\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://node-master:4040/jobs",
              "$$hashKey": "object:9110"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1710232650555_247605438",
      "id": "paragraph_1710232650555_247605438",
      "dateCreated": "2024-03-12T14:37:30+0600",
      "dateStarted": "2024-03-13T01:50:56+0600",
      "dateFinished": "2024-03-13T01:51:18+0600",
      "status": "FINISHED",
      "$$hashKey": "object:5408"
    },
    {
      "text": "%pyspark\nfrom pyspark import HiveContext\nfrom pyspark.sql.functions import year, count, when\n\n# Create a HiveContext\nhc = HiveContext(sc)\n\n# Read the table 'users' from Hive\ndf = hc.table('users')\n\n# Calculate yearly proportions of total users and silent users\nyearly_proportions = df.withColumn(\"signup_year\", year(\"user_yelping_since\")) \\\n    .groupBy(\"signup_year\") \\\n    .agg(count(\"*\").alias(\"total_users\"),\n         (count(when(df.user_review_count == 0, True)) / count(\"*\")).alias(\"silent_user_proportion\")) \\\n    .orderBy(\"signup_year\")\n\n# Show the yearly proportions\nz.show(yearly_proportions)\n",
      "user": "anonymous",
      "dateUpdated": "2024-03-13T07:27:34+0600",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "signup_year": "string",
                      "total_users": "string",
                      "silent_user_proportion": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "signup_year",
                  "index": 0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "total_users",
                  "index": 1,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "signup_year\ttotal_users\tsilent_user_proportion\n2004\t90\t0.0\n2005\t937\t0.0\n2006\t5423\t0.0\n2007\t15340\t0.0\n2008\t31097\t0.0\n2009\t64911\t0.0\n2010\t109054\t9.16976910521393E-6\n2011\t176435\t5.667809674951115E-6\n2012\t195955\t1.5309637416753845E-5\n2013\t209762\t4.767307710643491E-6\n2014\t233465\t4.283297282247874E-6\n2015\t247850\t8.06939681258826E-6\n2016\t217620\t1.3785497656465398E-5\n2017\t151024\t3.310732069075114E-5\n2018\t133568\t2.994729276473407E-5\n2019\t104655\t5.7331231188189764E-5\n2020\t47444\t1.4754236573644717E-4\n2021\t40485\t3.2110658268494504E-4\n2022\t2782\t0.0025161754133716753\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://node-master:4040/jobs",
              "$$hashKey": "object:9772"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1710233406211_1103786615",
      "id": "paragraph_1710233406211_1103786615",
      "dateCreated": "2024-03-12T14:50:06+0600",
      "dateStarted": "2024-03-13T01:49:26+0600",
      "dateFinished": "2024-03-13T01:49:52+0600",
      "status": "FINISHED",
      "$$hashKey": "object:5409"
    },
    {
      "text": "%pyspark\n#Summarize the yearly statistics for new users\nfrom pyspark import HiveContext\nfrom pyspark.sql.functions import year, count\n\n# Create a HiveContext\nhc = HiveContext(sc)\n\n# Read the table 'users' from Hive\ndf = hc.table('users')\n\n# Calculate yearly statistics for new users\nyearly_new_users = df.withColumn(\"signup_year\", year(\"user_yelping_since\")) \\\n    .groupBy(\"signup_year\") \\\n    .agg(count(\"*\").alias(\"new_users\")) \\\n    .orderBy(\"signup_year\")\n\n# Show the yearly statistics for new users\nz.show(yearly_new_users)\n\n",
      "user": "anonymous",
      "dateUpdated": "2024-03-13T07:27:45+0600",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "signup_year": "string",
                      "new_users": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "signup_year",
                  "index": 0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "new_users",
                  "index": 1,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "signup_year\tnew_users\n2004\t90\n2005\t937\n2006\t5423\n2007\t15340\n2008\t31097\n2009\t64911\n2010\t109054\n2011\t176435\n2012\t195955\n2013\t209762\n2014\t233465\n2015\t247850\n2016\t217620\n2017\t151024\n2018\t133568\n2019\t104655\n2020\t47444\n2021\t40485\n2022\t2782\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://node-master:4040/jobs",
              "$$hashKey": "object:10342"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1710236336705_796597619",
      "id": "paragraph_1710236336705_796597619",
      "dateCreated": "2024-03-12T15:38:56+0600",
      "dateStarted": "2024-03-13T01:48:35+0600",
      "dateFinished": "2024-03-13T01:49:02+0600",
      "status": "FINISHED",
      "$$hashKey": "object:5410"
    },
    {
      "text": "%pyspark\nfrom pyspark import HiveContext\nfrom pyspark.sql.functions import year, sum\n\n# Create a HiveContext\nhc = HiveContext(sc)\n\n# Read the table 'users' from Hive\ndf = hc.table('users')\n\n# Calculate yearly statistics for review counts\nyearly_review_counts = df.withColumn(\"signup_year\", year(\"user_yelping_since\")) \\\n    .groupBy(\"signup_year\") \\\n    .agg(sum(\"user_review_count\").alias(\"total_review_count\")) \\\n    .orderBy(\"signup_year\")\n\n# Show the yearly statistics for review counts\nz.show(yearly_review_counts)\n\n",
      "user": "anonymous",
      "dateUpdated": "2024-03-13T01:47:49+0600",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "signup_year": "string",
                      "total_review_count": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "signup_year\ttotal_review_count\n2004\t14577\n2005\t226005\n2006\t920176\n2007\t2011487\n2008\t3162898\n2009\t4401364\n2010\t5444361\n2011\t6344607\n2012\t5405586\n2013\t4820434\n2014\t4354298\n2015\t3630507\n2016\t2500839\n2017\t1457654\n2018\t938027\n2019\t559500\n2020\t197284\n2021\t112349\n2022\t3723\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://node-master:4040/jobs",
              "$$hashKey": "object:5747"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1710236405049_607332585",
      "id": "paragraph_1710236405049_607332585",
      "dateCreated": "2024-03-12T15:40:05+0600",
      "dateStarted": "2024-03-13T01:47:11+0600",
      "dateFinished": "2024-03-13T01:47:48+0600",
      "status": "FINISHED",
      "$$hashKey": "object:5411"
    },
    {
      "text": "%pyspark\nfrom pyspark import HiveContext\nfrom pyspark.sql.functions import year, count, when, col, expr\n\n# Create a HiveContext\nhc = HiveContext(sc)\n\n# Read the table 'users' from Hive\ndf = hc.table('users')\n\n# Calculate the total number of elite users and regular users each year\nyearly_user_counts = df.withColumn(\"signup_year\", year(\"user_yelping_since\")) \\\n    .groupBy(\"signup_year\") \\\n    .agg(count(when(df.user_elite == \"Y\", True)).alias(\"elite_users\"),\n         count(when(df.user_elite == \"N\", True)).alias(\"regular_users\")) \\\n    .orderBy(\"signup_year\")\n\n# Calculate the ratio of elite users to regular users each year\nyearly_user_ratio = yearly_user_counts.withColumn(\"elite_to_regular_ratio\", \n                                                  expr(\"IF(regular_users != 0, elite_users / regular_users, 0)\"))\n\n# Show the yearly ratio of elite users to regular users\nz.show(yearly_user_ratio)\n",
      "user": "anonymous",
      "dateUpdated": "2024-03-13T04:41:07+0600",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "signup_year": "string",
                      "elite_users": "string",
                      "regular_users": "string",
                      "elite_to_regular_ratio": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                },
                "stackedAreaChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                },
                "lineChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "signup_year",
                  "index": 0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "elite_users",
                  "index": 1,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          },
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "signup_year": "string",
                      "elite_users": "string",
                      "regular_users": "string",
                      "elite_to_regular_ratio": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "signup_year\telite_users\tregular_users\telite_to_regular_ratio\n2004\t0\t0\t0.0\n2005\t0\t0\t0.0\n2006\t0\t0\t0.0\n2007\t0\t0\t0.0\n2008\t0\t0\t0.0\n2009\t0\t0\t0.0\n2010\t0\t0\t0.0\n2011\t0\t0\t0.0\n2012\t0\t0\t0.0\n2013\t0\t0\t0.0\n2014\t0\t0\t0.0\n2015\t0\t0\t0.0\n2016\t0\t0\t0.0\n2017\t0\t0\t0.0\n2018\t0\t0\t0.0\n2019\t0\t0\t0.0\n2020\t0\t0\t0.0\n2021\t0\t0\t0.0\n2022\t0\t0\t0.0\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://node-master:4040/jobs",
              "$$hashKey": "object:9075"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1710261295511_1490071204",
      "id": "paragraph_1710261295511_1490071204",
      "dateCreated": "2024-03-12T22:34:55+0600",
      "dateStarted": "2024-03-13T01:41:25+0600",
      "dateFinished": "2024-03-13T01:44:33+0600",
      "status": "FINISHED",
      "$$hashKey": "object:5412"
    },
    {
      "text": "%pyspark\r\nfrom pyspark import HiveContext\r\nfrom pyspark.sql.functions import desc\r\n\r\nhc = HiveContext(sc)\r\ndf = hc.table('users')\r\n\r\n# Select \"user_id\" and \"user_fans\", and order by \"user_fans\" in descending order\r\npopular_users = df.select(\"user_id\", \"user_fans\").orderBy(desc(\"user_fans\"))\r\n\r\n# Limit the DataFrame to 10 rows\r\npopular_users_limit = popular_users.limit(10)\r\n\r\n# Show the DataFrame with the most popular users first\r\nz.show(popular_users_limit)\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-03-13T04:25:08+0600",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "user_id": "string",
                      "user_fans": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "user_id",
                  "index": 0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "user_fans",
                  "index": 1,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          },
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "user_id": "string",
                      "user_fans": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "user_id\tuser_fans\n37cpUoM8hlkSQfReIEBd-Q\t12497\nhizGc5W1tBHPghM5YKCAtg\t3642\nHi10sGSZNxQH3NLyWSZ1oA\t3493\nJjXuiru1_ONzDkYVrHN0aw\t3243\nj14WgRoU_-2ZE1aw1dXrJg\t3138\nVHdY6oG2JPVNjihWhOooAQ\t2627\niLjMdZi0Tm7DQxX1C1_2dg\t2547\nlt7bNHl-TXziny4FETu8nA\t2451\nfgwI3rYHOv1ipfVfCSx7pg\t2424\nITa3vh5ERI90G_WP4SmGUQ\t2388\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1710261389857_1248303355",
      "id": "paragraph_1710261389857_1248303355",
      "dateCreated": "2024-03-12T22:36:29+0600",
      "dateStarted": "2024-03-13T04:23:38+0600",
      "dateFinished": "2024-03-13T04:25:03+0600",
      "status": "FINISHED",
      "$$hashKey": "object:5413"
    },
    {
      "text": "%pyspark\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-03-13T02:11:21+0600",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1710262662565_2063082264",
      "id": "paragraph_1710262662565_2063082264",
      "dateCreated": "2024-03-12T22:57:42+0600",
      "dateStarted": "2024-03-13T02:11:21+0600",
      "dateFinished": "2024-03-13T02:12:14+0600",
      "status": "FINISHED",
      "$$hashKey": "object:5414"
    },
    {
      "text": "%pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2024-03-13T01:24:47+0600",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1710271487867_743717160",
      "id": "paragraph_1710271487867_743717160",
      "dateCreated": "2024-03-13T01:24:47+0600",
      "status": "READY",
      "$$hashKey": "object:5415"
    }
  ],
  "name": "UserAnlysis",
  "id": "2JTGGKWWW",
  "defaultInterpreterGroup": "spark",
  "version": "0.10.1",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {},
  "path": "/UserAnlysis"
}